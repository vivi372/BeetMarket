<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.beetmarket.review.ReviewMapper">

<!-- 리뷰 리스트 -->
<select id="list" resultType="com.beetmarket.review.vo.ReviewVO">
	select rno, reviewNo, WriteDate, starscore, reviewImage,  
	  reviewContent, goodsNo, orderNo, id, goodsName, photo
	from(
		select rownum rnum, rno, reviewNo, orderNo, goodsNo,
		WriteDate, starscore, reviewImage, reviewContent
		from(
			select 
				rno, r.reviewNo, r.WriteDate, r.starscore, r.reviewImage,  
	  				r.reviewContent, o.goodsNo, o.orderNo, o.id, g.goodsName m.photo
			from
				review r, orders o, goods g, member m
			where 
				(r.orderNo = o.orderNo) and (o.goodsNo = g.goodsNo) and (o.id = m.id)
			order rnum between  #{pageObject.startRow} and #{pageObject.endRow}
		)
	)
</select>

<select id="getTotalRow" resultType="Long">
	select count(*)
	from review
	where reviewNo = #{reviewNo}
</select>

</mapper>